name: Auto PR merge

on:
  pull_request:
    types:
      - opened

jobs:
  createPullRequestForStg:
    env:
      ENV: stg
    if:  startsWith(github.head_ref, 'feature/jenkins-ci2')
    runs-on: ubuntu-latest
    steps:
#      - uses: actions/checkout@v2
#      - name: Create Pull Request
#        id: cpr
#        uses: peter-evans/create-pull-request@v3
#        with:
#          token: ${{ secrets.GITHUB_TOKEN }}
#          commit-message: |
#            [${{ env.ENV }}] update container image
#          committer: GitHub <noreply@github.com>
#          author: ${{ github.actor }} <${{ github.actor }}@users.noreply.github.com>
#          signoff: false
#          branch: create-pull-request/release/${{ env.ENV }}
#          base: main
#          delete-branch: true
#          title: |
#            [${{ env.ENV }}] Update Container Image
#          body: |
#            [${{ env.ENV }}] Update Container Image
#            - Updated helm chart container image
#            - Auto-generated by [create-pull-request][1]
#            [1]: https://github.com/peter-evans/create-pull-request
#          labels: |
#            update container image
#            ${{ env.ENV }} release
#          assignees: tatsuro-m
#          draft: false
#
      - name: merge PR
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#        run: gh pr merge ${{ steps.cpr.outputs.pull-request-url }} --merge
        run: gh pr merge --repo https://github.com/tmonj1/self-hosted-runner-test --merge feature/jenkins-ci2
